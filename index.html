<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kresl√≠tko</title>
    <link rel="stylesheet" type="text/css" href="styles/reset.css">
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
    <link rel="stylesheet" href="libs/font-awesome-4.6.3/css/font-awesome.min.css">
    <script src="libs/saveSvgAsPng-gh-pages/saveSvgAsPng.js"></script>
    <script src="libs/jszip/dist/jszip.min.js"></script>

    <script type="application/javascript" src="src/Enums.js"></script>
    <script type="application/javascript" src="src/Consts.js"></script>

    <!-- model -->
    <script type="application/javascript" src="src/model/Entity.js"></script>
    <script type="application/javascript" src="src/model/Attribute.js"></script>
    <script type="application/javascript" src="src/model/AttributeList.js"></script>
    <script type="application/javascript" src="src/model/Relation.js"></script>
    <script type="application/javascript" src="src/model/RelationLeg.js"></script>

    <!-- view -->
    <script type="application/javascript" src="src/view/EditableText.js"></script>
    <script type="application/javascript" src="src/view/Entity.js"></script>
    <script type="application/javascript" src="src/view/Attribute.js"></script>
    <script type="application/javascript" src="src/view/Relation.js"></script>
    <script type="application/javascript" src="src/view/RelationLeg.js"></script>

    <!-- control -->
    <script type="application/javascript" src="src/control/Entity.js"></script>
    <script type="application/javascript" src="src/control/Attribute.js"></script>
    <script type="application/javascript" src="src/control/AttributeList.js"></script>
    <script type="application/javascript" src="src/control/Relation.js"></script>
    <script type="application/javascript" src="src/control/RelationLeg.js"></script>

    <script type="application/javascript" src="src/Random.js"></script>
    <script type="application/javascript" src="src/Diagram.js"></script>
    <script type="application/javascript" src="src/UI.js"></script>
    <script type="application/javascript" src="src/Canvas.js"></script>
    <script type="application/javascript" src="src/Layout.js"></script>
    <script type="application/javascript" src="src/Mouse.js"></script>
    <script type="application/javascript" src="src/Element.js"></script>
    <script type="application/javascript" src="src/Geometry.js"></script>
    <script type="application/javascript" src="src/Vector.js"></script>
    <script type="application/javascript" src="src/File.js"></script>
    <script type="application/javascript" src="src/Fullscreen.js"></script>
    <script type="application/javascript" src="src/MenuController.js"></script>
</head>
<body>


    <a href="javascript:toString();void(0);">to string</a>
    <a href="javascript:clear();void(0);">clear</a>

    <a href="javascript:saveEntityModels();void(0);">save</a>
    <a href="javascript:sort();void(0);">sort</a>
    <a href="javascript:im();void(0);">import</a>
    <a href="javascript:im2();void(0);">import2</a>
    <a href="javascript:ex();void(0);">export</a>

    <a href="javascript:canvas.Layout._moveToOrigin();void(0);">origin</a>

    <br />
    zoom
    <a href="javascript:canvas.zoomIn();void(0);">in</a>
    <a href="javascript:canvas.zoomOut();void(0);">out</a>
    <a href="javascript:canvas.zoomReset();void(0);">reset</a>

    <script>
        DBSDM.Diagram.init({
            showTutorial: false
        });

        var canvas = new DBSDM.Canvas();
        canvas.create();

        var json = JSON.parse('{"entities": [{"name": "DRUH","parent": null,"attr": [{"name": "id_druhu","primary": true,"unique": false,"nullable": false},{"name": "nazev","primary": false,"unique": false,"nullable": false}]},{"name": "KRMIC","parent": null,"attr": [{"name": "id_krmic","primary": true,"unique": false,"nullable": false},{"name": "adresa","primary": false,"unique": false,"nullable": false},{"name": "jmeno","primary": false,"unique": false,"nullable": false}]},{"name": "LEKAR","parent": null,"attr": [{"name": "id_lekare","primary": true,"unique": false,"nullable": false},{"name": "jmeno","primary": false,"unique": false,"nullable": false}]},{"name": "OBJEKT","parent": null,"attr": [{"name": "id_objektu","primary": true,"unique": false,"nullable": false}]},{"name": "PROHLIDKA","parent": null,"attr": [{"name": "datum","primary": true,"unique": false,"nullable": false}]},{"name": "ZVIRE","parent": null,"attr": [{"name": "id_zvirete","primary": true,"unique": false,"nullable": false},{"name": "dat_narozeni","primary": false,"unique": false,"nullable": false},{"name": "jmeno","primary": false,"unique": false,"nullable": false},{"name": "zeme_puvodu","primary": false,"unique": false,"nullable": false}]}],"relations": [[{"entity": "DRUH","identifying": false,"optional": true,"cardinality": 1},{"entity": "ZVIRE","identifying": true,"optional": false,"cardinality": 0}],[{"entity": "KRMIC","identifying": false,"optional": false,"cardinality": 1},{"entity": "OBJEKT","identifying": false,"optional": false,"cardinality": 0}],[{"entity": "LEKAR","identifying": false,"optional": true,"cardinality": 1},{"entity": "PROHLIDKA","identifying": false,"optional": false,"cardinality": 0}],[{"entity": "OBJEKT","identifying": false,"optional": true,"cardinality": 0},{"entity": "ZVIRE","identifying": false,"optional": false,"cardinality": 1}],[{"entity": "PROHLIDKA","identifying": true,"optional": false,"cardinality": 0},{"entity": "ZVIRE","identifying": false,"optional": true,"cardinality": 1}]]}');
        var json2 = JSON.parse('{"entities": [{"name": "Entity_3","parent": "Entity_1","attr": [{"name": "AC","primary": false,"unique": false,"nullable": true},{"name": "AV","primary": false,"unique": false,"nullable": true}]},{"name": "Entity_2","parent": null,"attr": [{"name": "Attribute_1","primary": false,"unique": true,"nullable": false},{"name": "Attribute_2","primary": false,"unique": true,"nullable": false},{"name": "Attribute_3","primary": false,"unique": false,"nullable": true},{"name": "Attribute_4","primary": false,"unique": false,"nullable": true}]},{"name": "Entity_1","parent": null,"attr": [{"name": "Attribute_11","primary": true,"unique": false,"nullable": false},{"name": "Attribute_33","primary": false,"unique": false,"nullable": false},{"name": "Attribute_22","primary": true,"unique": false,"nullable": false},{"name": "Attribute_44","primary": false,"unique": false,"nullable": true}]}],"relations": [[{"entity": "Entity_1","identifying": false,"optional": true,"cardinality": 0},{"entity": "Entity_2","identifying": false,"optional": false,"cardinality": 1}],[{"entity": "Entity_2","identifying": false,"optional": false,"cardinality": 1},{"entity": "Entity_3","identifying": false,"optional": false,"cardinality": 0}]]}');
        for (var i=0; i<2; i++) {
            var c = new DBSDM.Canvas();
            c.create();
            c.import(json);
        }

        function toString() {
            for (var i=0; i <canvas._entities.length; i++) {
                console.log(canvas._entities[i]._model.toString());
            }
        }

        function clear() {
            canvas.clear();
        }

        var entities = [];
        var relations = [];
        function saveEntityModels() {
            entities = [];
            var i;
            for (i=0; i <canvas._entities.length; i++) {
                entities.push(canvas._entities[i]._model);
            }
            console.log(entities);

            relations = [];
            for (i=0; i <canvas._relations.length; i++) {
                relations.push(canvas._relations[i]._model);
            }
        }

        function im() {
            canvas.import(json);
        }
        function im2() {
            canvas.import(json2);
        }
        function ex() {
            console.log(canvas.export(true, false));
        }

        function sort() {
            canvas.sort();
        }

    </script>

</body>
</html>